<div [ngClass]="marcaClass">

<div class="products-container">
  @for (producto of productos; track producto; let i = $index) {
    @if (producto.TIPO !== 'C') {
      <div class="product-card">
        <h2>{{ producto.DESC }}</h2>
        <img 
          class="product-img" 
          [src]="'https://objects.maestropizza.com/ksa/assets/rebranding/products/' + producto.COD + '.png'" 
          [alt]="producto.DESC" 
        />
        <p class="ingredientes-titulo">Ingredients before baking</p>
        <p class="elaboration-text">{{ producto.ELABORACION }}</p>

        <div class="ingredients-list">
          @for (ingrediente of obtenerIngredientes(producto); track ingrediente; let j = $index) {
            @if (j > 0 && obtenerIngredientes(producto)[j - 1].CAPA < 21 && ingrediente.CAPA >= 21) {
              <hr class="ingredientes-separador">
              <p class="ingredientes-titulo">Ingredients after baking</p>
            }

            <div class="ingredient-row">
              <img 
                class="ingredient-img" 
                [src]="'https://objects.maestropizza.com/ksa/assets/rebranding/toppings/' + ingrediente.COD + '.png'" 
                [alt]="ingrediente.DESC" 
              />
              <div class="ingredient-line"></div>
              <span class="ingredient-label">{{ ingrediente.DESC }} ({{ ingrediente.CANTIDAD }} {{ ingrediente.UNIDAD }})</span>
            </div>
}

        </div>
      </div>
    }

    @if (producto.TIPO === 'C') {
      <div class="product-card mitad-mitad">
        <h2>{{ producto.DESC }}</h2>
        <p class="elaboration-text">{{ producto.ELABORACION }}</p>

        <div class="halves-container">
          @for (mitad of producto.ARRAY_COMPOSICION; track mitad; let k = $index) {
            <div class="half-card">
              <h3>Half {{ k + 1 }}: {{ mitad.DESC }}</h3>
              <img 
                class="product-img" 
                [src]="'https://objects.maestropizza.com/ksa/assets/rebranding/products/' + mitad.COD + '.png'" 
                [alt]="mitad.DESC" 
                style="width: 100%; max-width: 250px;"
              />
              <p class="ingredientes-titulo">Ingredients before baking</p>
              <div class="ingredients-list">
                @for (ingrediente of obtenerIngredientes(mitad); track ingrediente; let j = $index) {
                  @if (j > 0 && obtenerIngredientes(mitad)[j - 1].CAPA < 21 && ingrediente.CAPA >= 21) {
                    <hr class="ingredientes-separador">
                    <p class="ingredientes-titulo">Ingredients after baking</p>
                  }

                  <div class="ingredient-row">
                    <img 
                      class="ingredient-img" 
                      [src]="'https://objects.maestropizza.com/ksa/assets/rebranding/toppings/' + ingrediente.COD + '.png'" 
                      [alt]="ingrediente.DESC" 
                    />
                    <div class="ingredient-line"></div>
                    <span class="ingredient-label">{{ ingrediente.DESC }} ({{ ingrediente.CANTIDAD }} {{ ingrediente.UNIDAD }})</span>
                  </div>
}

              </div>
            </div>
          }
        </div>
      </div>
    }
  }
</div>
</div>